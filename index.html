<!doctype html>
<html lang="ru">
<head>
	<meta charset="UTF-8">
	<title>Mon Cheri</title>
	<link rel="stylesheet" href="css/style.css">
	<!--[if lte IE 8]>
		<script src="html5.js"></script>
	<![endif]-->
</head>
<body>
	<header>
		<div class="nav-left">
			<!-- <a href="#" class="nav-link">Заказать</a> -->
			<a href="#" class="nav-link">Каталог</a>
		</div>
		<div class="logo"><h1>Mon Cheri</h1><div class="logo-shadow"></div></div>
		<div class="nav-right">
			<a href="#" class="nav-link">Контакты</a>
			<!-- <a href="#" class="nav-link">Ipsum</a> -->
		</div>
	</header>
	<div class="main-wrap">
	</div>
	<div class="item-modal">
		<div class="item-modal__b big-img"></div>
		<div class="sidebar">
			<div class="item-modal__b small-imgs"></div>
			<div class="item-modal__b sizes"></div>
			<div class="item-modal__b info"></div>
			<button class="confirm">ОТЛОЖИТЬ</button>
		</div>
	</div>
	<div class="item-modal-overlay"></div>
<script>
var MONCHERI = (function(){
	var main_wrap = document.querySelector(".main-wrap"),
		allItemsJSON, allItems = [];
		if (window.XMLHttpRequest) {
			var xhr = new XMLHttpRequest();
		}else{
			var xhr = new ActiveXObject("Microsoft.XMLHTTP");
		}

	function Item(o) {
		this.number = o.number;
		this.thumb = o.thumb;
		this.sizes = o.sizes;
		this.info = o.info;
		this.price = o.price;

		var div = document.createElement("div"),
			img = document.createElement("img"),
			ul = document.createElement("ul"),
			span = document.createElement("span");
		div.className = "item";
		img.src = this.thumb;
		ul.className = "sizes";

		this.div = main_wrap.appendChild(div);
		this.thumb = this.div.appendChild(img);
		this.ul = this.div.appendChild(ul);
		this.span = this.div.appendChild(span);

		for (var i=0; i<this.sizes.length; i++){
			var li = document.createElement("li");
			textContent(li, this.sizes[i]);
			this.ul.appendChild(li);
		}
		textContent(this.span, this.price);

		addEvent("click", this.div, function() {
			//nothing
		});

	}

	(function getAllItems(){
		if (!allItemsJSON){
			xhr.open("GET", "./catalog", true);
			xhr.onreadystatechange = function() {
				if (xhr.readyState == 4 && xhr.status == 200){
					allItemsJSON = JSON.parse(xhr.responseText);
					for (var prop in allItemsJSON){
						prop = new Item(allItemsJSON[prop]);
						allItems.push(prop);
					}
				}
			}
			xhr.send(null);
		}
	})();
	
	function textContent(el, val) {
		var content = el.textContent;
		if (content !== undefined){
			el.textContent = val;
		} else {
			el.innerText = val;
		}
	}

	function addEvent(type, el, handler) { //для кроссбраузерности
		if (el.addEventListener) {
			el.addEventListener(type, handler, false);
		} else {
			el.attachEvent("on"+type, handler)
		}
	}
})();
</script>
</body>
</html>